# 模拟环境使用指南

本文档介绍如何使用模拟环境来开发和测试前端应用，特别是处理认证相关的请求。

## 概述

模拟环境提供了一种方式，可以在没有后端服务的情况下开发和测试前端应用。它通过拦截API请求并返回模拟响应来实现这一点，特别是对于认证相关的请求（如登录、验证token、刷新token等）。

## 特性

- 拦截认证相关请求并返回模拟响应
- 处理401错误，避免在认证请求失败时执行登出操作
- 提供模拟用户和权限数据
- 与开发环境兼容

## 使用方法

### 启动模拟环境

```bash
npm run dev:mock
```

或者

```bash
yarn dev:mock
```

### 环境变量

模拟环境使用以下环境变量：

- `VITE_MOCK_MODE`: 启用模拟模式
- `VITE_MOCK_AUTH`: 启用认证请求的模拟
- `VITE_AUTO_MOCK_USER`: 自动模拟用户登录

这些变量在 `.env.mock` 文件中定义。

## 工作原理

### 模拟认证拦截器

模拟认证拦截器（`mockAuthInterceptor.ts`）拦截认证相关请求并返回模拟响应。它处理以下请求：

- `/auth/login`: 模拟登录
- `/auth/verify-token`: 模拟验证token
- `/auth/refresh`: 模拟刷新token
- `/auth/logout`: 模拟登出
- `/auth/permissions`: 模拟获取权限

### 401错误处理

在模拟模式下，对于认证相关请求返回401错误时，不会执行登出操作。这避免了在开发和测试过程中因为认证失败而被强制登出的情况。

### 模拟用户和权限

模拟环境提供了模拟用户和权限数据，可以用于开发和测试需要认证的功能。

## 注意事项

- 模拟环境仅用于开发和测试，不应在生产环境中使用。
- 模拟响应可能与实际后端响应有所不同，请确保在实际环境中进行充分测试。
- 如果遇到问题，请检查控制台日志，了解请求和响应的详细信息。